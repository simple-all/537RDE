function [x_Pr, x_Tr, x_V_CJ, x_R, x_gamma] = getCEAParams(q_phi, q_P_i, q_T_i)
%GETCEAPARAMS Dridded interpolant of CEA ouputs for H2/Air detonations
% Based off 80 data points
% INPUTS:
% q_phi: Equivalence ratio (between 0.8 and 1.4)
% q_P_i: Initial Pressure [Pa] Between 101325 and 303975 Pa
% q_T_i: Initial Temperature [K] Between 600 and 900 K


% CEA Inputs
% Equivalence Ratio
phi = [0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	0.8	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.2	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4	1.4];
% Initial Pressure [Pa]
P_i = [101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975	101325	151987	202650	253312	303975];
% Initial Temperature [K]
T_i = [600	600	600	600	600	700	700	700	700	700	800	800	800	800	800	900	900	900	900	900	600	600	600	600	600	700	700	700	700	700	800	800	800	800	800	900	900	900	900	900	600	600	600	600	600	700	700	700	700	700	800	800	800	800	800	900	900	900	900	900	600	600	600	600	600	700	700	700	700	700	800	800	800	800	800	900	900	900	900	900];

% Limit variables
if q_phi < min(phi)
    warning('Equivalence ratio limited to %0.3f!', min(phi))
    q_phi = min(phi);
end

if q_phi > max(phi)
    warning('Equivalence ratio limited to %0.3f!', max(phi))
    q_phi = max(phi);
end

if q_P_i < min(P_i)
    warning('Initial pressure limited to %0.3f Pa!', min(P_i))
    q_P_i = min(P_i);
end

if q_P_i > max(P_i)
    warning('Initial pressure limited to %0.3f Pa!', max(P_i))
    q_P_i = max(P_i);
end

if q_T_i < min(T_i)
    warning('Initial temperature limited to %0.3f K!', min(T_i))
    q_T_i = min(T_i);
end

if q_T_i > max(T_i)
    warning('Initial temperature limited to %0.3f K!', max(T_i))
    q_T_i = max(T_i);
end



% CEA Outputs
% Pressure Ratio
Pr = [7.389	7.434	7.463	7.485	7.502	6.356	6.4	6.429	6.451	6.468	5.577	5.62	5.649	5.671	5.688	4.969	5.011	5.04	5.061	5.078	7.74	7.808	7.854	7.889	7.918	6.631	6.693	6.736	6.769	6.795	5.798	5.856	5.897	5.927	5.952	5.15	5.204	5.242	5.271	5.295	7.821	7.887	7.933	7.967	7.994	6.702	6.765	6.808	6.84	6.866	5.862	5.92	5.961	5.992	6.016	5.206	5.262	5.3	5.33	5.354	7.76	7.817	7.855	7.883	7.905	6.664	6.719	6.756	6.784	6.806	5.837	5.891	5.927	5.955	5.976	5.191	5.243	5.279	5.306	5.327];
% Temperature Ratio
Tr = [4.762	4.804	4.833	4.854	3.871	4.121	4.161	4.188	4.209	4.225	3.639	3.677	3.703	3.723	3.739	3.263	3.299	3.324	3.343	3.359	4.979	5.038	5.079	5.11	5.135	4.291	4.344	4.381	4.409	4.432	3.774	3.823	3.857	3.884	3.905	3.373	3.418	3.45	3.474	3.494	5.032	5.092	5.133	5.164	5.189	4.336	4.39	4.428	4.457	4.48	3.814	3.864	3.899	3.926	3.947	3.407	3.454	3.486	3.512	3.532	4.999	5.053	5.09	5.117	5.139	4.315	4.365	4.399	4.426	4.446	3.8	3.847	3.88	3.905	3.925	3.398	3.443	3.474	3.498	3.517];
% Detonation CJ Velocity [m/s]
V_CJ = [1836.8	1844.5	1849.8	1853.7	1856.8	1828	1836.6	1842.5	1846.9	1850.3	1818.9	1828.3	1834.7	1839.5	1843.4	1809.2	1819.4	1826.4	1831.7	1835.9	1928.6	1939.1	1946.4	1951.9	1956.3	1916.6	1927.8	1935.5	1941.4	1946.2	1904.5	1916.3	1924.6	1930.9	1935.9	1892.2	1904.7	1913.4	1920.1	1925.5	1990.9	2001.8	2009.3	2014.9	2019.5	1978.6	1990.3	1998.4	2004.5	2009.5	1966.2	1978.7	1987.3	1993.9	1999.1	1953.5	1966.7	1975.9	1982.9	1988.5	2035.8	2046	2053	2058.2	2062.3	2024.7	2035.9	2043.6	2049.4	2053.9	2013.2	2025.3	2033.7	2040	2045	2001.2	2014.2	2023.2	2030	2035.4];
% Molecular weight [g/mol]
m = [24.907	24.949	24.978	25	25.017	24.827	24.873	24.905	24.929	24.948	24.742	24.793	24.828	24.854	24.875	24.654	24.708	24.745	24.774	24.797	23.724	23.779	23.818	23.847	23.871	23.629	23.687	23.728	23.759	23.784	23.532	23.593	23.636	23.669	23.695	23.434	23.497	23.542	23.576	23.604	22.534	22.587	22.624	22.652	22.675	22.443	22.5	22.539	22.569	22.593	22.351	22.41	22.451	22.483	22.509	22.257	22.318	22.362	22.395	22.422	21.41	21.456	21.488	21.512	21.531	21.33	21.38	21.414	21.44	21.461	21.247	21.3	21.337	21.365	21.388	21.161	21.217	21.256	21.286	21.31];
% Ratio of Specific Heats
gamma = [1.1671	1.1712	1.1741	1.1764	1.1782	1.1627	1.1667	1.1696	1.1718	1.1737	1.1589	1.1628	1.1656	1.1678	1.1696	1.1556	1.1594	1.1621	1.1642	1.166	1.1528	1.1561	1.1585	1.1604	1.1619	1.1503	1.1535	1.1559	1.1577	1.1592	1.1481	1.1513	1.1536	1.1554	1.1568	1.1461	1.1493	1.1515	1.1533	1.1548	1.1545	1.1584	1.1612	1.1634	1.1652	1.1514	1.155	1.1577	1.1598	1.1615	1.1487	1.1522	1.1548	1.1568	1.1584	1.1465	1.1498	1.1523	1.1542	1.1558	1.1632	1.1677	1.1711	1.1737	1.1758	1.1586	1.163	1.1661	1.1686	1.1707	1.1548	1.1589	1.1619	1.1643	1.1663	1.1516	1.1555	1.1584	1.1606	1.1625];

V = [phi' P_i' T_i'];
query = [q_phi, q_P_i, q_T_i];
x_Pr = griddatan(V, Pr', query);
x_Tr = griddatan(V, Tr', query);
x_V_CJ = griddatan(V, V_CJ', query);
x_R = 8314/griddatan(V, m', query);
x_gamma = griddatan(V, gamma', query);


end

